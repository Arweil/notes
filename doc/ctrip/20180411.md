## 0411版本总结
新公司接手的第一个项目，关于定制旅行的销售端数据面板

### 使用Promise执行链进行逻辑的分离
一般情况下，业务逻辑处理经历3个步骤:
1. 请求数据
2. 格式化数据
3. 渲染数据

甚至是一些数据的获取可能要经历很多接口查询才能接收到数据，比如: 从订单号获取到定制方案的ID,再从方案的ID查询出方案的详细信息。

所以使用Promise进行链式的业务是非常合适的上面的例子就可以写成
```javascript
Promise.resolve(params)
  .then(requestApiData1) // 请求接口A
  .then(getDataAndReturnParams) // 把接口A的数据获取到，并且返回接口B需要的数据
  .then(requestApiData2) // 请求接口B
  .then(formatData) // 格式化数据成为你需要的数据结构
  .then(renderData) // 进行数据渲染
  .catch(() => {
    // 异常的捕获与处理
  })
  .finally(() => {
    // 最后需要执行的，比如去掉loading
  })
```

这样写的好处很多:
1. 业务逻辑很清晰，浅显易懂，直接读懂整个流程在处理什么，不用刻意关注细节或者在逻辑里面跳来跳去;
2. 组合的关系方便替换，耦合性不高，比如要把A接口换成C接口，那么我只需要修改两个方法，分别为requestApiData1和getDataAndReturnParams;
3. 有catch作为异常的捕获，并且有finally作为执行完毕的总出口，比如loading统一在最后去掉，不用关心异常情况的关闭或者其他

不光如此，Promise.all方法也是业务逻辑编写经常用到的，比如: API方面给我一个数组，我可能需要对数组进行循环掉接口，或者一些需要并行调用接口的地方，同样也提供了统一的出口来进行处理

不过也确实就像上面说的那样，在上线前的一天，API的同事告诉我接口提供错了，我修改了请求接口和格式化数据两个方法花了很短的时间就搞定了。
对于接口粒度很细其实也是无可厚非，这样能够使后端代码耦合性降低。这是矛盾，但是我还是觉得应该有服务端包装一层供前端使用。

### 在项目开始前一定要熟悉框架
我们打算对项目进行重构，准备用一个内推的框架，但是我们的team对框架都并不熟悉，但是还是开始了代码的编写。很明显这样的风险是巨大的，也不出意料的出了意外，项目采用React同构，但是Node端的异常处理并没有暴露出来，这导致我们根本无法对node异常进行判断调试。最后重新用了老的框架，开发时间大幅缩短，开发风险直线上升。

这其实在之前的项目总结也有类似的经历，但是作为新人，对框架公司生产环境的不熟悉导致无法处理。还是要在项目前对项目易出问题的地方多多思考，多问，尽量阻止此类事情发生吧。（构建，开发，联调，上线各个阶段）
